# 正则表达式

## 特殊符号和字符

### 使用择一匹配符号匹配多个正则表达式模式

表示择一匹配的管道符号(|), 表示"从多个模式中选择其一"

|    正则表达式模式    |    匹配的字符串     |
| :-----------: | :-----------: |
|   at\|home    |   at, home    |
|  r2d2\|c3po   |  r2d2, c3po   |
| bat\|bet\|bit | bat, bet, bit |

### 匹配任意单个字符

点号或者句号(.)  匹配除了换行符\n以外的任意字符. 无论字母, 数字, 空格, 可打印字符, 不可打印字符, 还是一个符号, 使用点号能够匹配它们.

| 正则表达式模式 | 匹配的字符串                                 |
| :-----: | :------------------------------------- |
|   f.0   | 匹配在字母'f'和'o'之间的任意一个字符; 例如fao, f9o, f#o |
|   ..    | 任意两个字符                                 |
|  .end   | 匹配在字符串end之前的任意一个字符                     |

要显示匹配一个句点符号本身, 必须使用反斜杠转移句点符号的功能, 例如"\\."

### 从字符串起始或者结尾或者单词边界匹配

脱字符^或者特殊字符\A  用于制定在字符串的起始部分搜索. 美元符号$或者\Z, 用于指定在字符串结尾部分匹配. 表示的是搜索模式.

| 正则表达式模式       | 匹配的字符串                     |
| ------------- | -------------------------- |
| ^From         | 任何以From作为起始的字符串            |
| /bin/tcsh$    | 任何以/bin/tcsh作为结尾的字符串       |
| ^Subject: hi$ | 任何又单独的字符串Subject: hi构成的字符串 |

特殊字符\b和\B可以用来匹配字符边界, \b用于匹配单词的起始位置, 而\B讲匹配在一个单词中间的模式

| 正则表达式   | 匹配的字符串              |
| ------- | ------------------- |
| the     | 任何包含the的字符串         |
| \bthe   | 任何以the开始的字符串        |
| \bthe\b | 仅仅匹配单词the           |
| \Bthe   | 任何包含但并不以the作为起始的字符串 |

### 创建字符集

匹配某些特定字符

| 正则表达式               | 匹配的字符串                                   |
| ------------------- | ---------------------------------------- |
| b[aeiu]t            | bat, bet, bit, but                       |
| \[cr]\[23]\[dp][o2] | 一个包含四个字符的字符串, 第一个字符是'c'或'r', 然后是'2'或'3', 后面是'd'或'p', 最后要么是'o'要么是'2'. 例如: c2do, r3p2, r2d2, c3po等 |

### 限定范围和否定

方括号中两个符号中间用连字符(-)连接, 用于指定一个字符的范围. 如果脱字符(^)紧跟在左方括号后面,就表示不匹配给定字符集中的任何一个字符.

| 正则表达式模式             | 匹配的字符串                                 |
| ------------------- | -------------------------------------- |
| z.[0-9]             | 字符"z"后面跟着任何一个字符,然后跟着一个数字               |
| \[r-u]\[env-y]\[us] | 字母r,s,t或者u后面跟着e,n,v,w,x或者y, 然后跟着u或者s   |
| [^aeiou]            | 不匹配字符集                                 |
| [^\\t\\n]           | 不匹配制表符或\\n                             |
| ["-a]               | 在一个ASCII系统中, 所欲字符都位于""和"a"之间, 即34~97之间 |

### 使用闭包操作符实现存在性和频数匹配

*匹配其左边的正则表达式出现零次或者多次的情况, +匹配一次或者多次出现的正则表达式(正闭包), ? 操作符匹配零次或者一次出现的正则表达式.

{}里面是单个值或者是一对由逗号分割的值, 精确匹配前面的正则表达式N次({N})或者一定范围次数{M, N}匹配M~N次出现

| 正则表达式模式                         | 匹配的字符串                                   |
| ------------------------------- | ---------------------------------------- |
| [dn]ot?                         | 字母d或者n后面跟着一个o然后最多一个t,例如do, no, dot, not  |
| 0?[1-9]                         | 任意数值数字, 它可能前置一个0, 例如匹配一系列数(表示从1~9月的数值), 不管是一个还是后两个数字 |
| [0-9]{15,16]}                   | 匹配15或者16个数字(例如信用卡号码)                     |
| </?\[^\>]+>                     | 匹配全部有效的(和无效的)HTML标签                      |
| [KQRBNP]\[a-h][1-8]-\[a-h][1-8] | 在'长代数'标记法中,表示国际象棋合法的棋盘移动(仅移动不包括吃子和将军). 即K,Q,R,B,N,或P等字母后面加上a1~h8之间的棋盘坐标, 前面坐标表示从哪里开始走棋, 后面的坐标代表走到那个位置上. |

### 表示字符集的特殊字符

d表示匹配任何十进制数字. \w表示全部字母数字. \s可以用来表示空格字符. \D表示任何非十进制数(\[^0-9]相同), 等等.

| 正则表达式模式           | 匹配的字符串                               |
| ----------------- | ------------------------------------ |
| \w+-\d+           | 由一个字母数字组成的字符串和一串由一个连字符分隔的数字.         |
| [A-Za-z]\w*       | 第一个字符是字母;其余字符(如果存在)可以是字母或者数字.        |
| \d{3}-\d{3}-\d{4} | 美国电话号码的格式, 前面是区号的前缀, 例如 800-555-1212 |
| \w+@\w+\\.com     | 以XXX@YYY.com格式表示的简单电子邮件地址            |

### 使用圆括号指定分组

提取任何已经成功匹配的特定字符串或子字符串. 一对圆括号可以实现:

- 对正则表达式进行分组;
- 匹配子组

| 正则表达式模式                          | 匹配的字符串                                   |
| -------------------------------- | ---------------------------------------- |
| \d+(\\.\\d*)?                    | 表示简单浮点数的字符串; 也就是说, 任何十进制数, 后面可以接一个小数点和零个或者多个十进制数字, 例如'0.004','2','75.'等 |
| (Mr?s?\\.)?[A-Z]\[a-z]*[A-Za-z]+ | 名字和姓氏, 以及对名字的限制(如果有, 首字母必须大写,后续字母小写), 全名前可以有可选的'Mr','Mrs', 'Ms'或'M.'作为称谓, 以及灵活可选的姓氏,可以有多个单词,横线以及大写字母 |

### 扩展表示法

| 正则表达式模式           | 匹配的字符串                                   |
| ----------------- | ---------------------------------------- |
| (?:\w+\\.)*       | 以句号作为结尾的字符串,例如'google','twitter.','facebook.', 但这些匹配不会保存下来供后续的使用和数据检索 |
| (?#comment)       | 此处并不做匹配, 只是作为注释                          |
| (?=.com)          | 如果一个字符串后面跟着'.com'才做匹配操作, 并不使用任何目标字符串     |
| (?!.net)          | 如果一个字符串后面不是跟着.net才做匹配操作                  |
| (?<=800-)         | 如果字符串之前为'800-'才做匹配, 嘉定为电话号码, 同样,并不使用任何输入字符串 |
| (?<!192\\.168\\.) | 如果一个字符串之前不是'192.168.'才做匹配操作, 假定用于过滤掉一组C类IP地址 |
| (?(1)y\|x)        | 如果一个匹配组1(\\1)存在,就于Y匹配; 否则, 就与x匹配         |

## 正则表达式和python语言

### re模块: 核心函数和方法

在匹配发生之前, 正则表达式模式必须编译成正则表达式对象. 由于正则表达式在执行过程中将进行多次比较操作, 因此建议使用预编译. re.compile() 能够提供此功能.

正则表达式对象(regex object) 和正则匹配对象(regex match object)的方法同名而且具有相同的功能

### 使用compile()函数编译正则表达式

### 匹配对象以及group()和groups()方法

match()或者search()返回的对象:匹配对象. 此对象有两个主要方法group()和groups(), group()要么返回整个匹配对象, 要么根据要求返回特定子组. groups()则仅返回一个包含唯一或者全部子组的元祖.